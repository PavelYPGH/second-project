Анализ лояльности пользователей Яндекс Афиши



Целью проекта является определение факторов, влияющих на повторные покупки билетов, и выявление ключевых сегментов пользователей для повышения удержания и выручки.



Основные задачи проекта:

1. Выгрузка и изучение данных

Получение данных из базы, описание полей, проверка структуры.

2\. Приведение выручки к единой валюте (RUB)

Конвертация из тенге по курсу ЦБ РФ, создание столбца revenue\_rub.

3\. Проверка и предобработка данных

Обнаружение и обработка ошибок, аномалий, пропусков, дубликатов.

Оптимизация типов данных для экономии памяти.

4\. Анализ распределения числовых признаков

Проверка на выбросы, визуализация (revenue\_rub, tickets\_count), фильтрация по 99-му перцентилю.

5\. Построение профиля пользователя

Агрегация по user\_id: дата первого/последнего заказа, устройство, регион, оператор, жанр, статистики.

6\. Сегментация пользователей и анализ возврата

Группировка по признакам первого заказа, расчёт доли вернувшихся пользователей.

7\. Анализ факторов, влияющих на повторные покупки

Связь выручки, числа билетов, дня недели, интервала между заказами с лояльностью.

8\. Корреляционный анализ

Расчёт коэффициента корреляции между признаками профиля и числом заказов.



Краткие выводы:

1. Лояльность высокая — 73.6% пользователей совершили больше 2-х заказов, что указывает на сильную вовлечённость сервиса.

2\. Ключевой сегмент — пользователи, покупающие 2–3 билета за раз, демонстрируют наибольшую лояльность.

3\. День недели и тип устройства — не влияют на возврат.

4\. Самый сильный предиктор лояльности — средний интервал между заказами. Чем чаще пользователь возвращается — тем больше он покупает.

5\. Выручка и количество билетов — сильно коррелируют с повторными покупками: пользователи с чеком больше 600 руб. и 3+ билетами — наиболее ценные и устойчивые.

